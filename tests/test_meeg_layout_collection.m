function test_meeg_layout_collection
    initTestSuite;

function test_meeg_layout_collection_
    
    % define layout properties
    % order is:
    % - layout name
    % - number of channels
    % - some channel positions
    % - labels of channel positions

    lay_props={ {'yokogawa440.lay',440,...
                       [-0.3337 0.3729;-0.0108 0.0726],...
                       {'AG001','AG440'}},...
            {'neuromag306planar.lay',204,...
                       [-73.4162 33.4167;61.2202 -20.3860],...
                       {'MEG0113','MEG2643'}},...
            {'neuromag306mag.lay',102,...
                       [-67.4162 35.9167;67.2202 -22.8860],...
                       {'MEG0111','MEG2641'}},...
            {'neuromag306cmb.lay',102,...
                       [-67.4162 35.9167;67.2202 -22.8860],...
                       {'MEG0112+0113','MEG2642+2643'}},...
            {'neuromag306all.lay',306,...
                       [-73.4162 33.4167;67.2202 -22.8860],...
                       {'MEG0113','MEG2641'}},...
            {'elec1020.lay',21,...
                       [-0.3800 0.8911;0.3800 -0.8910],...
                       {'Fp1','O2'}},...
            {'elec1010.lay',86,...
                       [-0.2472 0.7609;0.3090 -0.9511],...
                       {'Fp1','I2'}},...
            {'elec1005.lay',335,...
                       [-0.2472 0.7609;0.2782 -0.8559],...
                       {'Fp1','OI2'}},...
            {'biosemi32.lay',32,...
                       [-0.4962 1.5271;0.0000 0.0000],...
                       {'Fp1','Cz'}},...
            {'biosemi128.lay',127,...
                       [0.0000 0.0000;-1.2990 -0.9438],...
                       {'A1','D31'}},...
            {'biosemi256.lay',255,...
                       [0.0000 0.0000;-0.7837 -1.7603],...
                       {'A1','H31'}},...
            {'EEG1020.lay',23,...
                       [-0.4853 1.4938;1.5708 1.5707],...
                       {'Fp1','SCALE'}},...
            {'EEG1010.lay',88,...
                       [-0.4853 1.4938;1.9635 1.5887],...
                       {'Fp1','SCALE'}},...
            {'EEG1005.lay',337,...
                       [-0.4853 1.4938;1.9635 1.7497],...
                       {'Fp1','SCALE'}},...
            {'CTF151.lay',153,...
                       [-0.4400 -4.0000;-5.5000 -1.5000],...
                       {'MLC11','COMNT'}},...
            {'CTF275.lay',275,...
                       [-0.0294 0.4282;0.0089 -0.2488],...
                       {'MLC11','MZP01'}},...
            {'4D148.lay',148,...
                       [0.5000 0.5644;0.9055 0.8111],...
                       {'A1','A148'}},...
            {'4D248.lay',248,...
                       [0.2306 -0.2606;34.3069 26.8896],...
                       {'A1','A248'}}};

    n=numel(lay_props);
    lc=cosmo_meeg_layout_collection();
    lc_names=cellfun(@(x) x.name,lc,'UniformOutput',false);
    for k=1:n
        lay_prop=lay_props{k};
        name=lay_prop{1};
        nchan=lay_prop{2};
        pos=lay_prop{3};
        label=lay_prop{4};

        i=find(cosmo_match(lc_names,name));
        assertEqual(numel(i),1);
        
        lay=lc{i};
        assertEqual(size(lay.pos,1),nchan);

        for j=1:numel(label)
            lab_i=find(cosmo_match(lay.label,label{j}));
            assert(numel(lab_i)==1);
            assertElementsAlmostEqual(lay.pos(lab_i,:),pos(j,:),...
                                    'absolute',1e-4);
        end
    end
    
    
    % the layout properties above were generated with the following code:
    %
    % lc=cosmo_meeg_layout_collection();
    % lcn=cellfun(@(x) x.name,lc,'UniformOutput',false);
    % for k=1:numel(names)
    %     fn=[names{k} '.lay'];
    %     m=find(cosmo_match(lcn,fn));
    %     lay=lc{m};
    %     desc=sprintf(['{''%s'',%d,...\n\t\t\t[%.4f %.4f;%.4f %.4f],'...
    %                     '...\n\t\t\t{''%s'',''%s''}},...'],...
    %                     lay.name,numel(lay.label),lay.pos([1 end],:)',...
    %                     lay.label{1}, lay.label{end});
    %     fprintf('%s\n',desc);
    % end
